type Query {
    # Island queries
    islands: [Island!]!
    island(name: String!): Island

    # Port queries
    ports: [Port!]!
    port(name: String!): Port
    nearbyPorts(
        portName: String!
        maxDistanceKm: Float
        limit: Int
    ): [PortDistance!]!
    shortestPathBetweenPorts(startPort: String!, endPort: String!): PortPath

    # Client queries
    clients: [Client!]!
    client(name: String!): Client

    # Locker queries
    lockers: [Locker!]!
    locker(portName: String!): Locker

    # Warehouse queries
    warehouses: [Warehouse!]!
    warehouse(name: String!): Warehouse

    # Seaplane queries
    seaplanes: [Seaplane!]!
    seaplane(name: String!): Seaplane
    seaplanesInMaintenance: [Seaplane!]!

    # Seaplane model queries
    seaplaneModels: [SeaplaneModel!]!
    seaplaneModel(name: String!): SeaplaneModel

    # Manufacturer queries
    manufacturers: [Manufacturer!]!
    manufacturer(name: String!): Manufacturer

    # Status queries
    seaplaneStatuses: [SeaplaneStatus!]!
    seaplaneStatus(value: String!): SeaplaneStatus

    # Order queries
    orders: [Order!]!
    order(id: String!): Order
    ordersByClient(clientId: Int!): [Order!]!
    ordersByWarehouse(warehouseId: Int!): [Order!]!
    ordersByStatus(status: String!): [Order!]!

    # Delivery queries
    deliveries: [Delivery!]!
    delivery(id: String!): Delivery
    deliveriesBySeaplane(seaplaneName: String!): [Delivery!]!
    deliveriesByStatus(status: String!): [Delivery!]!
    activeDeliveryForSeaplane(seaplaneName: String!): Delivery
    deliveryProgress(deliveryId: String!): DeliveryProgress
}

type Mutation {
    # Seaplane maintenance mutations
    moveSeaplaneIntoMaintenance(seaplaneName: String!): MaintenanceResponse!
    moveSeaplaneOutOfMaintenance(seaplaneName: String!): MaintenanceResponse!

    # Order mutations
    createOrder(
        client_id: Int!
        warehouse_id: Int!
        crateQuantity: Int!
    ): OrderResponse!
    updateOrderStatus(orderId: String!, status: String!): OrderResponse!
    cancelOrder(orderId: String!, reason: String): OrderResponse!

    # Delivery mutations
    createDelivery(
        orderIds: [String!]!
        seaplaneName: String!
    ): DeliveryResponse!
    startDelivery(deliveryId: String!): DeliveryResponse!
}

type MaintenanceResponse {
    success: Boolean!
    message: String!
    seaplane: Seaplane
}

type Island {
    name: String!
    ports: [Port!]!
}

type Port {
    name: String!
    latitude: Float!
    longitude: Float!
    island: Island
    locker: Locker
    warehouse: Warehouse
    seaplanes: [Seaplane!]!
}

type PortDistance {
    port: Port!
    distance_km: Float!
}

type PortPath {
    ports: [String!]!
    total_distance_km: Float!
    num_stops: Int!
}

type Client {
    name: String!
    specialty: String!
    locker: Locker
}

type Locker {
    capacity: Int!
    remaining_capacity: Int!
    port: Port!
    clients: [Client!]!
    id: Int!
}

type Warehouse {
    name: String!
    port: Port!
    id: Int!
}

type Seaplane {
    name: String!
    fuel: Float!
    crates: Int!
    model: SeaplaneModel!
    location: Port
    status: SeaplaneStatus!
    currentPosition: FlightPosition # Nullable - only present when flying
}

type FlightPosition {
    latitude: Float!
    longitude: Float!
    progress_percent: Float!
    distance_traveled_km: Float!
    distance_remaining_km: Float!
    estimated_arrival: String!
    departure_port: String!
    destination_port: String!
}

type SeaplaneModel {
    name: String!
    crate_capacity: Int!
    fuel_consumption_L_per_km: Float!
    fuel_capacity_L: Float!
    cost_per_km_USD: Float!
    average_speed_kmh: Float!
    manufacturer: Manufacturer!
    seaplanes: [Seaplane!]!
}

type Manufacturer {
    name: String!
    models: [SeaplaneModel!]!
}

type SeaplaneStatus {
    value: String!
    seaplanes: [Seaplane!]!
}

type Order {
    id: String!
    crate_quantity: Int!
    status: String!
    created_at: String!
    updated_at: String!
    delivered_at: String
    client: Client
    warehouse: Warehouse
    locker: Locker
}

type OrderResponse {
    success: Boolean!
    message: String!
    order: Order
}

type OrderStatistics {
    by_status: [StatusCount!]!
    total_orders: Int!
}

type StatusCount {
    _id: String!
    count: Int!
    total_crates: Int!
}

type Delivery {
    id: String!
    order_ids: [String!]!
    seaplane_name: String!
    route: [String!]!
    total_distance_km: Float!
    estimated_duration_hours: Float!
    status: String!
    created_at: String!
    started_at: String
    completed_at: String
    seaplane: Seaplane
    orders: [Order!]!
    progress: DeliveryProgress
}

type DeliveryResponse {
    success: Boolean!
    message: String!
    delivery: Delivery
}

type DeliveryProgress {
    status: String!
    current_leg: Int!
    current_port: String
    next_port: String
    departure_port: String
    position: FlightPosition
    progress_percent: Float!
    time_at_port: Float
    can_depart: Boolean!
}
